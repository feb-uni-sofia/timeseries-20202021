[["index.html", "Introduction to econometrics Chapter 1 Introduction", " Introduction to econometrics Boyko Amarov 2020-12-15 Chapter 1 Introduction A summary of class notes on time series analysis 2020/2021. library(xts) ## Loading required package: zoo ## ## Attaching package: &#39;zoo&#39; ## The following objects are masked from &#39;package:base&#39;: ## ## as.Date, as.Date.numeric "],["covariance.html", "Chapter 2 Sample covariance and sample correlation 2.1 Time series analysis class 2 2.2 Purely random process (white noise) 2.3 Simulation white noise 2.4 Sample (empirical) covariance 2.5 Expected value of \\(y_t\\) 2.6 Exercise", " Chapter 2 Sample covariance and sample correlation 2.1 Time series analysis class 2 Let us denote the realisations of a time series process with \\[ y: y_1, y_2,\\ldots,y_T \\] where \\(y_1\\) is the first value of the series and \\(y_T\\) is the last value of the series. The first lag of the series is defined as \\[ y_{t - 1}: \\text{ first lag} \\] 2.2 Purely random process (white noise) Let \\(u_t\\) be an uncorrelated, normally distributed zero mean process with constant variance \\(\\sigma^2\\). \\[ u_{t} \\sim N(0, \\sigma^2), \\quad t=1,\\ldots,T \\] 2.3 Simulation white noise Generate 100 values from a standard normal distribution (i.e. \\(\\sigma^2 = 1\\)) and create an arbitrary time index (here 100 days starting from 2018-10-10). randomValues &lt;- rnorm(100) timeIndex &lt;- seq.Date(as.Date(&quot;2018-10-10&quot;), by = &quot;day&quot;, length.out = 100) u &lt;- xts(randomValues, timeIndex) plot(u) mean(u) ## [1] 0.0508318 \\[ X \\sim N(\\mu, \\sigma^2)\\\\ \\text{ roughly } 95\\% \\text{ of the realisations of X are expected to be in the interval} \\\\ [\\mu - 2\\sigma, \\mu + 2\\sigma] \\] \\[ X \\sim N(0, 1)\\\\ [ - 2, 2] \\] uL1 &lt;- lag(u) combinedSeries &lt;- cbind(u, uL1) plot(as.data.frame(uL1)[, 1], as.data.frame(u)[, 1], xlab = &quot;u_{t - 1}&quot;, ylab = &quot;u_{t}&quot;, main = &quot;Scatterplot of u_t and u_{t - 1}&quot;) hist(as.data.frame(u)[, 1], main = &quot;Histogram of u&quot;) 2.4 Sample (empirical) covariance Let \\(x\\) and \\(y\\) be two random variables with \\(T\\) realisations. \\[ x: x_{1}, x_{2}, \\ldots, x_{T}\\\\ y: y_{1}, y_{2}, \\ldots, y_{T}\\\\ \\] 2.5 Expected value of \\(y_t\\) \\[ E(y_t) = E(x_t + 7u_t) = E(x_t) + E(7u_t) = x_{t} + E(7u_t) = x_{t} + 7\\underbrace{E(u_t)}_{0} = x_t \\\\ E(y_t) = x_t \\\\ Var(7u_t) = 7^2 \\underbrace{Var(u_t)}_{1} = 49 \\] \\[ E(y_t) = \\underbrace{E(x_t)}_{x_t} + \\underbrace{E(7u_t)}_{0} \\\\ E(u_t) = 0 \\text{ by the definition of the normal distribution with mean 0} \\\\ E(7u_t) = 7E(u_t) = 0 \\text{ because 7 is a constant (non-random)}\\\\ Var(7u_t) = 7^2Var(u_t) = 7^2\\times 1 \\] x &lt;- 1:50 noise &lt;- 20*rnorm(50) y &lt;- 100 * x + noise \\[ E(y_t) = E(x_t + u_t) = E(x_{t}) + \\underbrace{E(u_{t})}_{0} = E(x_t) \\] plot(x, y) mean(x) ## [1] 25.5 mean(y) ## [1] 2552.721 abline(v = mean(x), col = 3, lwd = 2) abline(h = mean(y), col = 2, lwd = 2) cov(x, y) ## [1] 21207.93 \\[ (x_t - \\overline{x})(y_{t} - \\overline{y}) &gt; 0 \\text{ for points in the top right part}\\\\ (x_t - \\overline{x})(y_{t} - \\overline{y}) &gt; 0 \\text{ for points in the bottom left part}\\\\ (x_t - \\overline{x})(y_{t} - \\overline{y}) &lt; 0 \\text{ for points in the bottom right and top left parts} \\] The sample covariance is defined as: \\[ Cov(x, y) = \\frac{1}{T - 1}\\sum_{t = 1}^{T}(x_t - \\overline{x})(y_{t} - \\overline{y}) \\] \\[ \\overline{y} = \\frac{1}{T}\\sum_{t = 1}^{T}y_{t} \\\\ (y_t - \\overline{y}) &gt; 0 \\text{ for points above the red line}\\\\ (y_t - \\overline{y}) &lt; 0 \\text{ for points below the red line}\\\\ (x_t - \\overline{x}) &gt; 0 \\text{ for points to the right of the green line}\\\\ (x_t - \\overline{x}) &lt; 0 \\text{ for points to the left of the green line} \\] $$ s^2(x) = {t = 1}^{T}(x_t - )2\\ s2(y) = {t = 1}^{T}(y_t - )^2\\ (x, y) = \\ -1 (x, y) 1 $$ \\[ y_{t} = - x_{t} \\] \\[ \\rho(x, y) = \\rho(x, x) = \\frac{Cov(x, x)}{\\sqrt{s^2(x)s^2(x)}} = \\frac{s^2(x)}{s^2(x)} = 1 \\] \\[ Cov(x, x) = \\frac{1}{T - 1}\\sum_{t = 1}^{T}(x_t - \\overline{x})^2 = Var(x) = s^2(x) \\] \\[ y_t = bx_{t} + a, \\quad b,a \\in R\\\\ b &gt; 0: \\rho(x, y) = 1\\\\ b &lt; 0: \\rho(x, y) = -1 \\\\ \\] \\[ y_t, y_{t - 1}, y_{t - 2},\\ldots, y_{t - k} \\] \\[ \\gamma_0 = Cov(y_t, y_{t}) = Var(y_t) = s^2(x)\\\\ \\gamma_{1} = Cov(y_{t}, y_{t - 1}) \\text{ first order autocovariance }\\\\ \\gamma_{2} = Cov(y_{t}, y_{t - 2}) \\text{ second order autocovariance } \\\\ \\gamma_{3} =Cov(y_{t}, y_{t - 3}) \\text{ third order autocovariance } \\\\ \\vdots \\\\ \\gamma_{k} =Cov(y_{t}, y_{t - k}) \\text{ k-th order autocovariance } \\\\ \\] \\[ \\rho_{0}= \\rho(y_t, y_{t}) = 1 \\\\ \\rho_{1} = \\rho(y_{t}, y_{t - 1}) \\text{ first order autocorrelation }\\\\ \\rho_{2} = \\rho(y_{t}, y_{t - 2}) \\text{ second order autocorrelation } \\\\ \\rho_{3} =\\rho(y_{t}, y_{t - 3}) \\text{ third order autocorrelation } \\\\ \\vdots \\\\ \\rho_{k} =\\rho(y_{t}, y_{t - k}) \\text{ k-th order autocorrelation } \\\\ \\] \\[ \\rho_1 = \\frac{\\gamma_1}{\\gamma_0} \\\\ \\rho_2 = \\frac{\\gamma_2}{\\gamma_0} \\\\ \\vdots\\\\ \\rho_k = \\frac{\\gamma_k}{\\gamma_0}\\\\ \\] \\[ \\text{Assume that } s^2(y_t) = s^2(y_{t - 1}) \\\\ \\rho_{1} = \\rho(y_t, y_{t - 1}) = \\frac{Cov(y_t, y_{t - 1})}{\\sqrt{s^2(y_t)s^2(y_{t})}} = \\frac{Cov(y_t, y_{t - 1})}{s^2(y_t)} = \\frac{\\gamma_1}{\\gamma_0} \\] \\[ u_t \\sim N(0, 1) \\\\ u_{t} \\text{ and } u_{t - k} \\text{ are not correlated for each } k \\neq 0. \\] 2.6 Exercise Compute the sample first order autocovariance of the following time series. $$ x: x_1, x_2, x_3\\ x: (2, 3, 10)\\ Cov(x_t, x_{t - 1}) = {t = 1}^{T}(x_t - )(x{t - 1} - )\\ = 5\\ 1 = Cov(x_t, x{t - 1}) = [(2 - 5)(NA - 5) + (3 - 5)(2 - 5) + (10 - 5)(3 - 5)] =\\ = [NA + (-2)(-3) + (5)(-2)] = (6 -10) = -2\\ 1 = -2\\ {1} = ? \\ s^2(x) = Var(x_{t}) = _{t = 1}^{T}=\\ [(2 - 5)^2 + (3 - 5)^2 + (10 - 5)^2] = [(-3)^2 + (-2)^2 + 5^2] = \\ [9 + 4 + 25] = = 19\\ 0 = 19\\ {1} = = = … $$ We can check that our result is correct by running the same calculation with R: var(c(2, 3, 10)) ## [1] 19 acf(c(2, 3, 10), plot = FALSE) ## ## Autocorrelations of series &#39;c(2, 3, 10)&#39;, by lag ## ## 0 1 2 ## 1.000 -0.105 -0.395 "]]
